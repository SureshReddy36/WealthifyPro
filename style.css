:root {
  --bg: #0f1220;
  --panel: rgba(255, 255, 255, 0.06);
  --panel-opaque: #181c2f;
  --text: #e8e8f0;
  --muted: #a7aec0;
  --border: rgba(255, 255, 255, 0.12);
  --shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
  --primary-start: #667eea;
  --primary-end: #764ba2;
  --success: #22c55e;
  --danger: #ef4444;
  --card-radius: 20px;
  --input-radius: 14px;
  --transition: 0.3s ease;
}

/* Light theme */
.light {
  --bg: #f7f8fc;
  --panel: rgba(0, 0, 0, 0.04);
  --panel-opaque: #ffffff;
  --text: #0f1220;
  --muted: #5d6475;
  --border: rgba(0, 0, 0, 0.08);
  --shadow: 0 10px 30px rgba(15, 18, 32, 0.08);
}

/* Palette overrides */
/* Light palettes */
.light[data-palette="mint-cream"] {
  --bg: #f5fff7;
  --panel-opaque: #ffffff;
  --panel: rgba(0, 128, 96, 0.06);
  --text: #0c1220;
  --muted: #506060;
  --primary-start: #34d399;
  --primary-end: #10b981;
}
.light[data-palette="warm-beige"] {
  --bg: #f7efe8;
  --panel-opaque: #ffffff;
  --panel: rgba(120, 64, 0, 0.06);
  --text: #1a1410;
  --muted: #6b5b52;
  --primary-start: #f59e0b;
  --primary-end: #d97706;
}
.light[data-palette="soft-teal"] {
  --bg: #e6fffb;
  --panel-opaque: #ffffff;
  --panel: rgba(0, 128, 128, 0.06);
  --text: #0c1117;
  --muted: #4a6a6a;
  --primary-start: #14b8a6;
  --primary-end: #0ea5e9;
}
.light[data-palette="lavender-mist"] {
  --bg: #f5f3ff;
  --panel-opaque: #ffffff;
  --panel: rgba(88, 28, 135, 0.06);
  --text: #121024;
  --muted: #5c577a;
  --primary-start: #a78bfa;
  --primary-end: #7c3aed;
}
.light[data-palette="sky-breeze"] {
  --bg: #e0f2fe;
  --panel-opaque: #ffffff;
  --panel: rgba(14, 165, 233, 0.06);
  --text: #0c1821;
  --muted: #475569;
  --primary-start: #38bdf8;
  --primary-end: #0284c7;
}
.light[data-palette="blush-rose"] {
  --bg: #fff1f2;
  --panel-opaque: #ffffff;
  --panel: rgba(244, 63, 94, 0.06);
  --text: #1c0f13;
  --muted: #64485c;
  --primary-start: #fb7185;
  --primary-end: #e11d48;
}
.light[data-palette="ivory-glow"] {
  --bg: #fffef9;
  --panel-opaque: #ffffff;
  --panel: rgba(202, 138, 4, 0.05);
  --text: #1a1814;
  --muted: #71706b;
  --primary-start: #fbbf24;
  --primary-end: #ca8a04;
}
.light[data-palette="ocean-pearl"] {
  --bg: #ecfeff;
  --panel-opaque: #ffffff;
  --panel: rgba(6, 182, 212, 0.06);
  --text: #0c1720;
  --muted: #476372;
  --primary-start: #22d3ee;
  --primary-end: #0891b2;
}
.light[data-palette="lemon-frost"] {
  --bg: #fefce8;
  --panel-opaque: #ffffff;
  --panel: rgba(202, 138, 4, 0.06);
  --text: #1a1c0f;
  --muted: #6b6e54;
  --primary-start: #facc15;
  --primary-end: #ca8a04;
}
.light[data-palette="cloud-drift"] {
  --bg: #f8fafc;
  --panel-opaque: #ffffff;
  --panel: rgba(100, 116, 139, 0.05);
  --text: #0f172a;
  --muted: #64748b;
  --primary-start: #94a3b8;
  --primary-end: #475569;
}
.light[data-palette="frost-mint"] {
  --bg: #f0fdfa;
  --panel-opaque: #ffffff;
  --panel: rgba(20, 184, 166, 0.06);
  --text: #0c1615;
  --muted: #4d6965;
  --primary-start: #5eead4;
  --primary-end: #14b8a6;
}
.light[data-palette="peach-glow"] {
  --bg: #fff7ed;
  --panel-opaque: #ffffff;
  --panel: rgba(251, 146, 60, 0.06);
  --text: #1c1410;
  --muted: #78523b;
  --primary-start: #fb923c;
  --primary-end: #f97316;
}
.light[data-palette="sand-dune"] {
  --bg: #fafaf9;
  --panel-opaque: #ffffff;
  --panel: rgba(120, 113, 108, 0.05);
  --text: #1c1917;
  --muted: #78716c;
  --primary-start: #d6d3d1;
  --primary-end: #a8a29e;
}
.light[data-palette="snow-lilac"] {
  --bg: #faf5ff;
  --panel-opaque: #ffffff;
  --panel: rgba(168, 85, 247, 0.06);
  --text: #1a1024;
  --muted: #6b5c7a;
  --primary-start: #c084fc;
  --primary-end: #9333ea;
}

/* Dark palettes (only when not in light mode) */
:root:not(.light)[data-palette="emerald-night"] {
  --bg: #0b1420;
  --panel-opaque: #11182a;
  --panel: rgba(34, 197, 94, 0.06);
  --text: #e6fff3;
  --muted: #9ad1be;
  --primary-start: #22c55e;
  --primary-end: #059669;
}
:root:not(.light)[data-palette="rust-orange"] {
  --bg: #0f0a07;
  --panel-opaque: #18120f;
  --panel: rgba(249, 115, 22, 0.08);
  --text: #ffeede;
  --muted: #d6b8a6;
  --primary-start: #f97316;
  --primary-end: #ea580c;
}
:root:not(.light)[data-palette="charcoal-violet"] {
  --bg: #131424;
  --panel-opaque: #191a2e;
  --panel: rgba(139, 92, 246, 0.08);
  --text: #ece9ff;
  --muted: #b9b2da;
  --primary-start: #8b5cf6;
  --primary-end: #6d28d9;
}
:root:not(.light)[data-palette="deep-plum"] {
  --bg: #1a1024;
  --panel-opaque: #201433;
  --panel: rgba(217, 70, 239, 0.08);
  --text: #ffeefe;
  --muted: #d9b8e6;
  --primary-start: #d946ef;
  --primary-end: #a21caf;
}
:root:not(.light)[data-palette="midnight-blue"] {
  --bg: #0c1225;
  --panel-opaque: #111827;
  --panel: rgba(59, 130, 246, 0.08);
  --text: #e1e8ff;
  --muted: #93a8d9;
  --primary-start: #3b82f6;
  --primary-end: #1d4ed8;
}
:root:not(.light)[data-palette="wine-red"] {
  --bg: #1a0a0f;
  --panel-opaque: #2a1118;
  --panel: rgba(220, 38, 38, 0.08);
  --text: #ffe5e9;
  --muted: #d99aab;
  --primary-start: #dc2626;
  --primary-end: #991b1b;
}
:root:not(.light)[data-palette="onyx-shadow"] {
  --bg: #0a0a0a;
  --panel-opaque: #171717;
  --panel: rgba(115, 115, 115, 0.08);
  --text: #e5e5e5;
  --muted: #a3a3a3;
  --primary-start: #737373;
  --primary-end: #404040;
}
:root:not(.light)[data-palette="deep-sea"] {
  --bg: #071318;
  --panel-opaque: #0f1e26;
  --panel: rgba(6, 182, 212, 0.08);
  --text: #d9f5ff;
  --muted: #7ec4d9;
  --primary-start: #06b6d4;
  --primary-end: #0e7490;
}
:root:not(.light)[data-palette="amber-gold"] {
  --bg: #1a1408;
  --panel-opaque: #2a2010;
  --panel: rgba(245, 158, 11, 0.08);
  --text: #fff5d9;
  --muted: #d9c47a;
  --primary-start: #f59e0b;
  --primary-end: #d97706;
}
:root:not(.light)[data-palette="storm-grey"] {
  --bg: #0f1419;
  --panel-opaque: #18202a;
  --panel: rgba(100, 116, 139, 0.08);
  --text: #e2e8f0;
  --muted: #94a3b8;
  --primary-start: #64748b;
  --primary-end: #334155;
}
:root:not(.light)[data-palette="forest-pine"] {
  --bg: #0a1410;
  --panel-opaque: #11221c;
  --panel: rgba(34, 197, 94, 0.08);
  --text: #d9ffe8;
  --muted: #7ac49a;
  --primary-start: #16a34a;
  --primary-end: #15803d;
}
:root:not(.light)[data-palette="mocha-brown"] {
  --bg: #120d08;
  --panel-opaque: #1f1710;
  --panel: rgba(180, 83, 9, 0.08);
  --text: #ffe8d1;
  --muted: #c9a882;
  --primary-start: #b45309;
  --primary-end: #92400e;
}
:root:not(.light)[data-palette="copper-dust"] {
  --bg: #1a0e0a;
  --panel-opaque: #2a1814;
  --panel: rgba(234, 88, 12, 0.08);
  --text: #ffebe0;
  --muted: #d9a68d;
  --primary-start: #ea580c;
  --primary-end: #c2410c;
}
:root:not(.light)[data-palette="twilight-purple"] {
  --bg: #14091a;
  --panel-opaque: #221029;
  --panel: rgba(168, 85, 247, 0.08);
  --text: #f5e6ff;
  --muted: #c9a3d9;
  --primary-start: #a855f7;
  --primary-end: #7e22ce;
}

* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  background: var(--bg);
  color: var(--text);
  transition: background var(--transition), color var(--transition);
}

.app-header {
  position: sticky;
  top: 0;
  z-index: 50;
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 24px;
  background: linear-gradient(180deg, rgba(0,0,0,0.35), rgba(0,0,0,0))
              ,var(--panel);
  -webkit-backdrop-filter: blur(12px);
  backdrop-filter: blur(12px);
  border-bottom: 1px solid var(--border);
}
.header-left { display: flex; align-items: center; gap: 12px; }
.header-right { display: flex; align-items: center; gap: 10px; flex-wrap: nowrap; }
.app-icon { font-size: 22px; }
.app-title {
  margin: 0;
  font-size: 18px;
  font-weight: 700;
  letter-spacing: 0.2px;
  transform: translateY(6px);
  opacity: 0;
  animation: titleIn 600ms var(--transition) forwards;
}
@keyframes titleIn { to { transform: translateY(0); opacity: 1; } }

.icon-button {
  border: 1px solid var(--border);
  background: var(--panel-opaque);
  color: var(--text);
  width: 40px; height: 40px;
  border-radius: 12px;
  display: grid; place-items: center;
  cursor: pointer;
  transition: transform var(--transition), box-shadow var(--transition), background var(--transition);
}
.icon-button:hover { transform: translateY(-2px); box-shadow: var(--shadow); }

/* Explicit theme toggle colors */
#themeToggle { background: #0b0b0b; color: #ffffff; border-color: rgba(255,255,255,0.15); }
.light #themeToggle { background: #ffffff; color: #0f1220; border-color: rgba(0,0,0,0.15); }

.container {
  max-width: 1100px;
  margin: 28px auto;
  padding: 0 16px;
  display: grid;
  grid-template-columns: 1fr;
  gap: 22px;
}

@media (min-width: 960px) {
  .container { grid-template-columns: 1fr 1fr; }
}

.note-card { grid-column: 1 / -1; }
.notes-list { margin: 0; padding-left: 18px; color: var(--muted); line-height: 1.5; }
.notes-list li + li { margin-top: 6px; }

.palette-select {
  height: 40px;
  border-radius: 12px;
  border: 1px solid var(--border);
  background: var(--panel-opaque);
  color: var(--text);
  margin-right: 8px;
  padding: 0 10px;
  max-width: 240px;
}

.card {
  background: var(--panel-opaque);
  border: 1px solid var(--border);
  border-radius: var(--card-radius);
  box-shadow: var(--shadow);
  padding: 18px;
  transition: transform var(--transition), box-shadow var(--transition), background var(--transition);
}
.card:hover { transform: translateY(-4px); box-shadow: 0 18px 40px rgba(0,0,0,0.2); }
.card-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; }
.card-header-actions { display: flex; align-items: center; gap: 8px; }
.card h2 { margin: 0; font-size: 18px; }

.grid.two-col { display: grid; grid-template-columns: 1fr; gap: 12px; }
@media (min-width: 640px) { .grid.two-col { grid-template-columns: 1fr 1fr; } }

.form-group { display: flex; flex-direction: column; gap: 8px; }
.form-group label { font-size: 13px; color: var(--muted); }
.form-group input, .form-group select {
  width: 100%; height: 44px;
  border-radius: var(--input-radius);
  border: 1px solid var(--border);
  background: color-mix(in oklab, var(--panel-opaque) 70%, transparent);
  color: var(--text);
  padding: 0 14px;
  outline: none;
  transition: border var(--transition), box-shadow var(--transition), background var(--transition);
}
.form-group input:focus, .form-group select:focus {
  border-color: color-mix(in oklab, var(--primary-end) 40%, var(--border));
  box-shadow: 0 0 0 4px color-mix(in oklab, var(--primary-start) 20%, transparent);
}

.hidden { display: none !important; }

.actions { display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap; }

.button {
  position: relative;
  border: 0;
  padding: 12px 16px;
  border-radius: 14px;
  cursor: pointer;
  font-weight: 600;
  color: #fff;
  background: linear-gradient(135deg, var(--primary-start) 0%, var(--primary-end) 100%);
  transition: transform var(--transition), box-shadow var(--transition), filter var(--transition), opacity var(--transition);
}
.button.primary { color: #fff; }
.button.secondary { color: #fff; filter: saturate(0.7) brightness(0.9); }
.button.ghost { background: transparent; color: var(--text); border: 1px solid var(--border); }
.button.tiny { padding: 8px 10px; font-size: 12px; border-radius: 10px; }
.button:hover { transform: translateY(-2px) scale(1.01); box-shadow: 0 10px 24px color-mix(in oklab, var(--primary-end) 25%, transparent); }
.button:disabled { opacity: 0.6; cursor: not-allowed; }

.results { margin-top: 14px; display: grid; grid-template-columns: 1fr; gap: 10px; }
.result-card {
  background: var(--panel);
  -webkit-backdrop-filter: blur(10px);
  backdrop-filter: blur(10px);
  border: 1px solid var(--border);
  border-radius: 16px;
  padding: 14px;
  display: flex; align-items: center; justify-content: space-between;
}
.result-card.total { border-color: color-mix(in oklab, var(--primary-end) 40%, var(--border)); }
.result-label { color: var(--muted); font-size: 13px; }
.result-amount { font-size: 22px; font-weight: 700; }

.result-inline { display: flex; align-items: center; justify-content: space-between; padding: 8px 0; border-bottom: 1px dashed var(--border); }
.result-inline:last-child { border-bottom: 0; }
.muted { color: var(--muted); }

.history { margin-top: 14px; }
.history-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; }
.history-list { list-style: none; margin: 0; padding: 0; display: grid; gap: 8px; }
.history-list li { padding: 10px 12px; border: 1px dashed var(--border); border-radius: 12px; background: color-mix(in oklab, var(--panel-opaque) 70%, transparent); }

.error { margin-top: 10px; color: #fff; background: color-mix(in oklab, var(--danger) 35%, transparent); border: 1px solid color-mix(in oklab, var(--danger) 50%, var(--border)); padding: 10px 12px; border-radius: 12px; }

.fade-in { opacity: 0; transform: translateY(6px); animation: fadeIn 400ms var(--transition) forwards; }
@keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }

.loading-shimmer { position: relative; height: 6px; border-radius: 10px; overflow: hidden; background: color-mix(in oklab, var(--panel-opaque) 70%, transparent); margin-top: 14px; }
.loading-shimmer::after { content: ""; position: absolute; inset: 0; transform: translateX(-100%); background: linear-gradient(90deg, transparent, rgba(255,255,255,0.35), transparent); animation: shimmer 1.2s infinite; }
@keyframes shimmer { to { transform: translateX(100%); } }

.app-footer { text-align: center; color: var(--muted); font-size: 12px; padding: 24px 16px 40px; }
.app-footer .footer-link { color: inherit; text-decoration: underline dotted; }
.app-footer .footer-link:hover { color: var(--text); text-decoration: underline; }

/* Calculator Modal */
.calc-modal { border: 0; padding: 0; background: transparent; }
.calc-modal::backdrop { background: rgba(0,0,0,0.45); -webkit-backdrop-filter: blur(4px); backdrop-filter: blur(4px); }
.calc-window {
  width: min(420px, 92vw);
  margin: auto;
  background: color-mix(in oklab, var(--panel-opaque) 80%, transparent);
  border: 1px solid var(--border);
  border-radius: 18px;
  box-shadow: 0 30px 80px rgba(0,0,0,0.35);
  overflow: hidden;
  transform: scale(0.96);
  opacity: 0;
  animation: modalIn 200ms var(--transition) forwards;
}
@keyframes modalIn { to { transform: scale(1); opacity: 1; } }
.calc-header { display: flex; align-items: center; justify-content: space-between; padding: 14px 14px; border-bottom: 1px solid var(--border); }
.calc-header h3 { margin: 0; color: var(--text); }
.calc-display { padding: 12px 14px; background: var(--panel); -webkit-backdrop-filter: blur(8px); backdrop-filter: blur(8px); border-bottom: 1px solid var(--border); }
.calc-display input { width: 100%; height: 54px; border-radius: 12px; border: 1px solid var(--border); background: var(--panel-opaque); color: var(--text); font-size: 20px; padding: 0 12px; }
.calc-actions { padding: 10px 14px; display: flex; gap: 8px; }
.calc-grid { padding: 10px 14px 14px; display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
.calc-grid button { height: 44px; border-radius: 12px; border: 1px solid var(--border); background: var(--panel); color: var(--text); cursor: pointer; transition: transform var(--transition), box-shadow var(--transition), background var(--transition); }
.calc-grid button:hover { transform: translateY(-2px); box-shadow: var(--shadow); }
.calc-grid .equals { background: linear-gradient(135deg, var(--primary-start) 0%, var(--primary-end) 100%); color: #fff; border: 0; }
.calc-history { padding: 8px 14px 14px; border-top: 1px solid var(--border); }
.calc-history h4 { margin: 0 0 8px; color: var(--text); }
.calc-history .history-list li { color: var(--text); }

.toast { position: fixed; left: 50%; bottom: 24px; transform: translateX(-50%) translateY(10px); background: color-mix(in oklab, var(--panel-opaque) 85%, transparent); border: 1px solid var(--border); color: var(--text); padding: 10px 14px; border-radius: 12px; opacity: 0; transition: transform var(--transition), opacity var(--transition); }
.toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

.tooltip { font-size: 12px; color: var(--muted); }

